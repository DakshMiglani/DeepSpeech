#!/bin/bash

set -xe

source ../tmp/venv/bin/activate

data="${DATA_ROOT}/shared/data"
fis="${data}/LDC/fisher"
swb="${data}/LDC/LDC97S62/swb"
lbs="${data}/OpenSLR/LibriSpeech/librivox"
cv="${data}/mozilla/CommonVoice/v2.0-alpha2.0/en/cv_en_valid"

echo 'model_checkpoint_path: "best_validation"
all_model_checkpoint_paths: "best_validation"
' > ../keep/checkpoint

python3 -u evaluate.py \
  --test_files "${lbs}-dev-clean.csv","${lbs}-dev-other.csv","${cv}_dev.csv" \
  --hdf5_test_set "../keep/librispeech-cv2.0-alpha2-dev-all.hdf5" \
  --test_batch_size 48 \
  --n_hidden 2048 \
  --learning_rate 0.0001 \
  --dropout_rate 0.15 \
  --epoch 30 \
  --report_count 0 \
  --display_step 0 \
  --validation_step 1 \
  --checkpoint_dir "../keep" \
  --summary_dir "../keep/summaries"
